from .dol import apply_hack
from dataclasses import dataclass


LEVEL_TYPES = [
  "campaign",
  "multiplayer"
]

CAMPAIGN_LEVEL_NAMES = [
  "wedmmines01",
  "wedmmines02",
  "wedmmines03",
  "wedttown_01",
  "wewtrace_01",
  "wewjjourn01",
  "wewjjourn02",
  "wewjjourn03",
  "wewzzombi01",
  "wewccomm_01",
  "wewccomm_02",
  "wewccomm_03",
  "wewchold_01",
  "wewrresrch1",
  "wewrresrch2",
  "wewrresrch3",
  "wewrresrch4",
  "wewhchase01",
  "wermmorbot1",
  "wermmorbot2",
  "werrreactr1",
  "werrreactr2",
  "wemccity_01",
  "wemccity_03",
  "wecffacty01",
  "wemccity_05",
  "wecrruins01",
  "wecrruins02",
  "wemccity_02",
  "wecdsneak01",
  "wecdsneak02",
  "wediinvas01",
  "webccolis01",
  "webccolis02",
  "webccolis03",
  "webccolis04",
  "wewkrockt01",
  "weshhangr01",
  "wessstatn01",
  "wessstatn02",
  "wesrrepair1",
  "wesccorros1",
]

MULTIPLAYER_LEVEL_NAMES = [
  "we01multi01",
  "we02multi02",
  "we03multi03",
  "we05multi05",
  "we11multi11",
  "we15multi15",
  "we08multi08",
  "we12multi12",
  "we14multi14",
  "we09multi09",
  "we10multi10",
  "we07multi07",
  "we04multi04",
  "we06multi06",
]

LEVEL_BOT_MAP = [
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "mozer",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "krunk",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "slosh",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
  "glitch",
]

@dataclass
class Level:
  title: str
  wld_resource_name: str
  #level_id: int - too be calculated at runtime, not stored
  csv_file: str
  csv_material_file: str
  load_ptr: int
  unload_ptr: int
  work_ptr: int
  draw_ptr: int
  projector_offsets: float
  projector_range_adjustment: float

DEFAULT_SP_LEVEL_ARRAY = [
  Level(
    "1 Seal the Mines",
    "WEDMmines01",
    "WEDMmines01",
    "ms_mines01",
    0,
    0,
    0,
    0,
    0.0,
    1.0),
  Level(
    "2 Seal the Mines",
    "WEDMmines02",
    "WEDMmines02",
    "ms_mines02",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  Level(
    "3 Seal the Mines",
    "WEDMmines03",
    "WEDMmines03",
    "ms_mines03",
    0,
    0,
    0,
    0,
    10.0,
    4.0,
  Level(
    "4 Clean Up",
    "WEDTtown_01",
    "WEDTtown_01",
    "ms_town_01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "5 RAT race",
    "WEWTrace_01",
    "WEWTrace_01",
    "ms_race_01",
    0,
    0,
    0,
    0,
    50.0,
    4.0,
  ),
  Level(
    "6 Wasteland Journey",
    "WEWJjourn01",
    "WEWJjourn01",
    "ms_journ01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
    "7 Wasteland Journey",
    "WEWJjourn02",
    "WEWJjourn02",
    "ms_journ02",
    0,
    0,
    0,
    0,
    10.0,
    4.0,
  ),
  Level(
    "8 Wasteland Journey",
    "WEWJjourn03",
    "WEWJjourn03",
    "ms_journ03",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "9 ZombieBot Boss",
    "WEWZzombi01",
    "WEWZzombi01",
    "ms_zombi01",
    0x80132ba0,
    0x80142c24,
    0x80142c90,
    0x801b10b8,
    0.0,
    1.0,
  ),
  Level(
    "10 Destroy Comm Cntr",
    "WEWCcomm_01",
    "WEWCcomm_01",
    "ms_comm_01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "11 Destroy Comm Cntr",
    "WEWCcomm_02",
    "WEWCcomm_02",
    "ms_comm_02",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "12 Destroy Comm Cntr",
    "WEWCcomm_03",
    "WEWCcomm_03",
    "ms_comm_03",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "13 Hold Your Ground",
    "WEWChold_01",
    "WEWChold_01",
    "ms_hold_01",
    0x8012a548,
    0x8012bbf4,
    0x8012bc40,
    0x801b10b8,
    0.0,
    1.0,
  ),
  Level(
    "14 R & D",
    "WEWRresrch1",
    "WEWRresrch1",
    "ms_resrch1",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "15 R & D",
    "WEWRresrch2",
    "WEWRresrch2",
    "ms_resrch2",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "16 R & D",
    "WEWRresrch3",
    "WEWRresrch3",
    "ms_resrch3",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "17 R & D",
    "WEWRresrch4",
    "WEWRresrch4",
    "ms_resrch4",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "18 Wasteland Chase",
    "WEWHchase01",
    "WEWHchase01",
    "ms_chase01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
    Level(
    "19 Morbot Region",
    "WERMmorbot1",
    "WERMmorbot1",
    "ms_morbot1",
    0,
    0,
    0,
    0,
    10.0,
    4.0,
  ),
  Level(
    "20 Morbot Region",
    "WERMmorbot2",
    "WERMmorbot2",
    "ms_morbot2",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "21 Reactor",
    "WERRreactr1",
    "WERRreactr1",
    "ms_reactr1",
    0,
    0,
    0,
    0,
    10.0,
    4.0,
  ),
  Level(
    "22 Reactor",
    "WERRreactr2",
    "WERRreactr2",
    "ms_reactr2",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "23 Mil City Hub",
    "WEMCcity_01",
    "WEMCcity_01",
    "ms_city_01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "24 Mil City Hub",
    "WEMCcity_03",
    "WEMCcity_03",
    "ms_city_03",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "25 Spy vs. Spy",
    "WECFfacty01",
    "WECFfacty01",
    "ms_facty01",
    0x8013bb2c,
    0x8013c11c,
    0x8013c224,
    0,
    0.0,
    1.0,
  ),
  Level(
    "26 Ruins",
    "WEMCcity_05",
    "WEMCcity_05",
    "ms_city_05",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "27 Ruins",
    "WECRruins01",
    "WECRruins01",
    "ms_ruins01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "28 Ruins",
    "WECRruins02",
    "WECRruins02",
    "ms_ruins02",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "29 Secret Rendezvous",
    "WEMCcity_02",
    "WEMCcity_02",
    "ms_city_02",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "30 Night Sneak",
    "WECDsneak01",
    "WECDsneak01",
    "ms_sneak01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "31 Night Sneak",
    "WECDsneak02",
    "WECDsneak02",
    "ms_sneak02",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "32 Invasion",
    "WEDiinvas01",
    "WEDiinvas01",
    "ms_invas01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "33 Coliseum",
    "WEBCcolis01",
    "WEBCcolis01",
    "ms_colis01",
    0x8014405c,
    0x80144d10,
    0x80145748,
    0,
    0.0,
    1.0,
  ),
  Level(
    "34 Coliseum",
    "WEBCcolis02",
    "WEBCcolis02",
    "ms_colis02",
    0x80144100,
    0x80144d10,
    0x80145748,
    0,
    0.0,
    1.0,
  ),
  Level(
    "35 Coliseum",
    "WEBCcolis03",
    "WEBCcolis03",
    "ms_colis03",
    0x80144224,
    0x80144d10,
    0x80145748,
    0,
    0.0,
    1.0,
  ),
  Level(
    "36 Coliseum",
    "WEBCcolis04",
    "WEBCcolis04",
    "ms_colis04",
    0x80144330,
    0x80144d10,
    0x80145748,
    0,
    0.0,
    1.0,
  ),
  Level(
    "37 Race to the Rocket",
    "WEWKrockt01",
    "WEWKrockt01",
    "ms_rockt01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "38 Space Dock",
    "WESHhangr01",
    "WESHhangr01",
    "ms_hangr01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "39 Space Station",
    "WESSstatn01",
    "WESSstatn01",
    "ms_statn01",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "40 Space Station",
    "WESSstatn02",
    "WESSstatn02",
    "ms_statn02",
    0,
    0,
    0,
    0,
    0.0,
    1.0,
  ),
  Level(
    "41 Gen. Corrosive",
    "WESRrepair1",
    "WESRrepair1",
    "ms_repair1",
    0x80127954,
    0x801279f0,
    0x801b0908,
    0x801b10b8,
    0.0,
    1.0,
  ),
  Level(
    "42 Final Battle",
    "WESCcorros1",
    "WESCcorros1",
    "ms_corros1",
    0x80129fec,
    0x8012a07c,
    0x801b092c,
    0,
    0.0,
    1.0,
  ),

],

def apply_level_count_overrides(dol, sp_count, mp_count):
  cmpwi = 0x2c170000 + count
  cmplwi = 0x28000000 + count


  # Everywhere i can find where level count is referred to in code
  # SP OVERRIDES
  apply_hack(dol, [0x041c87ac, cmpwi])
  apply_hack(dol, [0x04154e10, cmpwi])
  apply_hack(dol, [0x041c8c88, cmpwi])
  apply_hack(dol, [0x041c8d08, cmpwi - 1])
  apply_hack(dol, [0x04157cac, cmplwi])
  apply_hack(dol, [0x04158faf, cmplwi])
  # subi to subtract sp count
  apply_hack(dol, [0x04158f94, 0x3816ffff - sp_count + 1])
  # MP OVERRIDES
  apply_hack(dol, [0x0415903c, cmplwi + mp_count])
  apply_hack(dol, [0x04158f8c, cmplwi + mp_count])

  # TODO ASM CODE FOR AUTO EXECUTE

